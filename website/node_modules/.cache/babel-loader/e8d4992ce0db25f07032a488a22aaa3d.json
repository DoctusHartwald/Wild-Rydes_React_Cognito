{"ast":null,"code":"/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport { I18n, ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { Auth } from '@aws-amplify/auth';\nimport AmplifyTheme from '../../Amplify-UI/Amplify-UI-Theme';\nimport { facebookSignInButton } from '@aws-amplify/ui';\nimport { SignInButton, SignInButtonIcon, SignInButtonContent } from '../../Amplify-UI/Amplify-UI-Components-React';\nimport { Constants } from '../common/constants';\nvar logger = new Logger('withFacebook');\nexport function withFacebook(Comp) {\n  return function (_super) {\n    __extends(class_1, _super);\n\n    function class_1(props) {\n      var _this = _super.call(this, props) || this;\n\n      _this.fbAsyncInit = _this.fbAsyncInit.bind(_this);\n      _this.initFB = _this.initFB.bind(_this);\n      _this.signIn = _this.signIn.bind(_this);\n      _this.signOut = _this.signOut.bind(_this);\n      _this.federatedSignIn = _this.federatedSignIn.bind(_this);\n      _this.state = {};\n      return _this;\n    }\n\n    class_1.prototype.signIn = function () {\n      var _this = this;\n\n      var fb = window.FB;\n      fb.getLoginStatus(function (response) {\n        var payload = {\n          provider: Constants.FACEBOOK\n        };\n\n        try {\n          localStorage.setItem(Constants.AUTH_SOURCE_KEY, JSON.stringify(payload));\n        } catch (e) {\n          logger.debug('Failed to cache auth source into localStorage', e);\n        }\n\n        if (response.status === 'connected') {\n          _this.federatedSignIn(response.authResponse);\n        } else {\n          fb.login(function (response) {\n            if (!response || !response.authResponse) {\n              return;\n            }\n\n            _this.federatedSignIn(response.authResponse);\n          }, {\n            scope: 'public_profile,email'\n          });\n        }\n      });\n    };\n\n    class_1.prototype.federatedSignIn = function (response) {\n      logger.debug(response);\n      var onStateChange = this.props.onStateChange;\n      var accessToken = response.accessToken,\n          expiresIn = response.expiresIn;\n      var date = new Date();\n      var expires_at = expiresIn * 1000 + date.getTime();\n\n      if (!accessToken) {\n        return;\n      }\n\n      var fb = window.FB;\n      fb.api('/me', {\n        fields: 'name,email,picture'\n      }, function (response) {\n        var user = {\n          name: response.name,\n          email: response.email,\n          picture: response.picture.data.url\n        };\n\n        if (!Auth || typeof Auth.federatedSignIn !== 'function' || typeof Auth.currentAuthenticatedUser !== 'function') {\n          throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n        }\n\n        Auth.federatedSignIn('facebook', {\n          token: accessToken,\n          expires_at: expires_at\n        }, user).then(function (credentials) {\n          return Auth.currentAuthenticatedUser();\n        }).then(function (authUser) {\n          if (onStateChange) {\n            onStateChange('signedIn', authUser);\n          }\n        });\n      });\n    };\n\n    class_1.prototype.signOut = function () {\n      var fb = window.FB;\n\n      if (!fb) {\n        logger.debug('FB sdk undefined');\n        return Promise.resolve();\n      }\n\n      fb.getLoginStatus(function (response) {\n        if (response.status === 'connected') {\n          return new Promise(function (res, rej) {\n            logger.debug('facebook signing out');\n            fb.logout(function (response) {\n              res(response);\n            });\n          });\n        } else {\n          return Promise.resolve();\n        }\n      });\n    };\n\n    class_1.prototype.componentDidMount = function () {\n      var facebook_app_id = this.props.facebook_app_id;\n      if (facebook_app_id && !window.FB) this.createScript();\n    };\n\n    class_1.prototype.fbAsyncInit = function () {\n      logger.debug('init FB');\n      var facebook_app_id = this.props.facebook_app_id;\n      var fb = window.FB;\n      fb.init({\n        appId: facebook_app_id,\n        cookie: true,\n        xfbml: true,\n        version: 'v2.11'\n      });\n      fb.getLoginStatus(function (response) {\n        return logger.debug(response);\n      });\n    };\n\n    class_1.prototype.initFB = function () {\n      var fb = window.FB;\n      logger.debug('FB inited');\n    };\n\n    class_1.prototype.createScript = function () {\n      window.fbAsyncInit = this.fbAsyncInit;\n      var script = document.createElement('script');\n      script.src = 'https://connect.facebook.net/en_US/sdk.js';\n      script.async = true;\n      script.onload = this.initFB;\n      document.body.appendChild(script);\n    };\n\n    class_1.prototype.render = function () {\n      var fb = window.FB;\n      return React.createElement(Comp, __assign({}, this.props, {\n        fb: fb,\n        facebookSignIn: this.signIn,\n        facebookSignOut: this.signOut\n      }));\n    };\n\n    return class_1;\n  }(React.Component);\n}\n\nvar Button = function (props) {\n  return React.createElement(SignInButton, {\n    id: facebookSignInButton,\n    onClick: props.facebookSignIn,\n    theme: props.theme || AmplifyTheme,\n    variant: 'facebookSignInButton'\n  }, React.createElement(SignInButtonIcon, {\n    theme: props.theme || AmplifyTheme\n  }, React.createElement(\"svg\", {\n    viewBox: \"0 0 279 538\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, React.createElement(\"g\", {\n    id: \"Page-1\",\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, React.createElement(\"g\", {\n    id: \"Artboard\",\n    fill: \"#FFF\"\n  }, React.createElement(\"path\", {\n    d: \"M82.3409742,538 L82.3409742,292.936652 L0,292.936652 L0,196.990154 L82.2410458,196.990154 L82.2410458,126.4295 C82.2410458,44.575144 132.205229,0 205.252865,0 C240.227794,0 270.306232,2.59855099 279,3.79788222 L279,89.2502322 L228.536175,89.2502322 C188.964542,89.2502322 181.270057,108.139699 181.270057,135.824262 L181.270057,196.89021 L276.202006,196.89021 L263.810888,292.836708 L181.16913,292.836708 L181.16913,538 L82.3409742,538 Z\",\n    id: \"Fill-1\"\n  }))))), React.createElement(SignInButtonContent, {\n    theme: props.theme || AmplifyTheme\n  }, I18n.get('Sign In with Facebook')));\n};\n\nexport var FacebookButton = withFacebook(Button);\n/**\n * @deprecated use named import\n */\n\nexport default withFacebook;","map":{"version":3,"sources":["../../../src/Auth/Provider/withFacebook.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport { I18n, ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { Auth } from '@aws-amplify/auth';\nimport AmplifyTheme from '../../Amplify-UI/Amplify-UI-Theme';\nimport { facebookSignInButton } from '@aws-amplify/ui';\nimport { SignInButton, SignInButtonIcon, SignInButtonContent, } from '../../Amplify-UI/Amplify-UI-Components-React';\nimport { Constants } from '../common/constants';\nvar logger = new Logger('withFacebook');\nexport function withFacebook(Comp) {\n    return /** @class */ (function (_super) {\n        __extends(class_1, _super);\n        function class_1(props) {\n            var _this = _super.call(this, props) || this;\n            _this.fbAsyncInit = _this.fbAsyncInit.bind(_this);\n            _this.initFB = _this.initFB.bind(_this);\n            _this.signIn = _this.signIn.bind(_this);\n            _this.signOut = _this.signOut.bind(_this);\n            _this.federatedSignIn = _this.federatedSignIn.bind(_this);\n            _this.state = {};\n            return _this;\n        }\n        class_1.prototype.signIn = function () {\n            var _this = this;\n            var fb = window.FB;\n            fb.getLoginStatus(function (response) {\n                var payload = {\n                    provider: Constants.FACEBOOK,\n                };\n                try {\n                    localStorage.setItem(Constants.AUTH_SOURCE_KEY, JSON.stringify(payload));\n                }\n                catch (e) {\n                    logger.debug('Failed to cache auth source into localStorage', e);\n                }\n                if (response.status === 'connected') {\n                    _this.federatedSignIn(response.authResponse);\n                }\n                else {\n                    fb.login(function (response) {\n                        if (!response || !response.authResponse) {\n                            return;\n                        }\n                        _this.federatedSignIn(response.authResponse);\n                    }, {\n                        scope: 'public_profile,email',\n                    });\n                }\n            });\n        };\n        class_1.prototype.federatedSignIn = function (response) {\n            logger.debug(response);\n            var onStateChange = this.props.onStateChange;\n            var accessToken = response.accessToken, expiresIn = response.expiresIn;\n            var date = new Date();\n            var expires_at = expiresIn * 1000 + date.getTime();\n            if (!accessToken) {\n                return;\n            }\n            var fb = window.FB;\n            fb.api('/me', { fields: 'name,email,picture' }, function (response) {\n                var user = {\n                    name: response.name,\n                    email: response.email,\n                    picture: response.picture.data.url,\n                };\n                if (!Auth ||\n                    typeof Auth.federatedSignIn !== 'function' ||\n                    typeof Auth.currentAuthenticatedUser !== 'function') {\n                    throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n                }\n                Auth.federatedSignIn('facebook', { token: accessToken, expires_at: expires_at }, user)\n                    .then(function (credentials) {\n                    return Auth.currentAuthenticatedUser();\n                })\n                    .then(function (authUser) {\n                    if (onStateChange) {\n                        onStateChange('signedIn', authUser);\n                    }\n                });\n            });\n        };\n        class_1.prototype.signOut = function () {\n            var fb = window.FB;\n            if (!fb) {\n                logger.debug('FB sdk undefined');\n                return Promise.resolve();\n            }\n            fb.getLoginStatus(function (response) {\n                if (response.status === 'connected') {\n                    return new Promise(function (res, rej) {\n                        logger.debug('facebook signing out');\n                        fb.logout(function (response) {\n                            res(response);\n                        });\n                    });\n                }\n                else {\n                    return Promise.resolve();\n                }\n            });\n        };\n        class_1.prototype.componentDidMount = function () {\n            var facebook_app_id = this.props.facebook_app_id;\n            if (facebook_app_id && !window.FB)\n                this.createScript();\n        };\n        class_1.prototype.fbAsyncInit = function () {\n            logger.debug('init FB');\n            var facebook_app_id = this.props.facebook_app_id;\n            var fb = window.FB;\n            fb.init({\n                appId: facebook_app_id,\n                cookie: true,\n                xfbml: true,\n                version: 'v2.11',\n            });\n            fb.getLoginStatus(function (response) { return logger.debug(response); });\n        };\n        class_1.prototype.initFB = function () {\n            var fb = window.FB;\n            logger.debug('FB inited');\n        };\n        class_1.prototype.createScript = function () {\n            window.fbAsyncInit = this.fbAsyncInit;\n            var script = document.createElement('script');\n            script.src = 'https://connect.facebook.net/en_US/sdk.js';\n            script.async = true;\n            script.onload = this.initFB;\n            document.body.appendChild(script);\n        };\n        class_1.prototype.render = function () {\n            var fb = window.FB;\n            return (React.createElement(Comp, __assign({}, this.props, { fb: fb, facebookSignIn: this.signIn, facebookSignOut: this.signOut })));\n        };\n        return class_1;\n    }(React.Component));\n}\nvar Button = function (props) { return (React.createElement(SignInButton, { id: facebookSignInButton, onClick: props.facebookSignIn, theme: props.theme || AmplifyTheme, variant: 'facebookSignInButton' },\n    React.createElement(SignInButtonIcon, { theme: props.theme || AmplifyTheme },\n        React.createElement(\"svg\", { viewBox: \"0 0 279 538\", xmlns: \"http://www.w3.org/2000/svg\" },\n            React.createElement(\"g\", { id: \"Page-1\", fill: \"none\", fillRule: \"evenodd\" },\n                React.createElement(\"g\", { id: \"Artboard\", fill: \"#FFF\" },\n                    React.createElement(\"path\", { d: \"M82.3409742,538 L82.3409742,292.936652 L0,292.936652 L0,196.990154 L82.2410458,196.990154 L82.2410458,126.4295 C82.2410458,44.575144 132.205229,0 205.252865,0 C240.227794,0 270.306232,2.59855099 279,3.79788222 L279,89.2502322 L228.536175,89.2502322 C188.964542,89.2502322 181.270057,108.139699 181.270057,135.824262 L181.270057,196.89021 L276.202006,196.89021 L263.810888,292.836708 L181.16913,292.836708 L181.16913,538 L82.3409742,538 Z\", id: \"Fill-1\" }))))),\n    React.createElement(SignInButtonContent, { theme: props.theme || AmplifyTheme }, I18n.get('Sign In with Facebook')))); };\nexport var FacebookButton = withFacebook(Button);\n/**\n * @deprecated use named import\n */\nexport default withFacebook;\n//# sourceMappingURL=withFacebook.js.map"]},"metadata":{},"sourceType":"module"}